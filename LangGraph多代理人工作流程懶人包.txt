# 檔名：LangGraph多代理人工作流程懶人包

**一言以蔽之**
LangGraph 是一個強大的框架，能讓開發者輕鬆建構包含循環（cycles）的複雜多代理人（multi-agent）工作流程，藉由將代理人視為圖節點，並透過邊緣定義其互動與狀態轉換，實現更靈活、可控的 AI 應用。

**關鍵重點**
*   LangGraph 專注於建構包含循環的多代理人 LLM 工作流程，將代理人視為圖中的節點，互動由邊緣定義。
*   「多代理人」意指多個由語言模型驅動的獨立實體，各自擁有獨特的提示、LLM、工具，並透過特定方式相互連接與協作。
*   LangGraph 提供三種範例工作流程：「多代理人協作」（共享訊息記錄本）、「代理人主管」（獨立訊息記錄本，由主管調度）及「階層式代理人團隊」（代理人節點本身可以是 LangGraph 物件）。
*   相較於 Autogen，LangGraph 提供更精細的圖形化控制與開發體驗；相較於 CrewAI，LangGraph 則提供更底層的控制權。
*   LangGraph 已整合至 LangChain 生態系，可利用 LangChain 的豐富資源與 LangSmith 的可觀察性。

**詳細摘要**
LangGraph 是一個新推出的開源套件（支援 Python 和 JS），旨在解決建立包含循環的 LLM 工作流程的挑戰，這對於大多數代理人運行時（agent runtimes）至關重要。本次重點介紹其在「多代理人工作流程」上的應用。

**什麼是「多代理人」？**
「多代理人」指的是由語言模型驅動的、多個獨立運作的實體，它們之間的連接方式經過特定設計。每個代理人都可以擁有自己的提示（prompt）、大型語言模型（LLM）、工具（tools）及客製化程式碼，以達成最佳協作。在思考多代理人工作流程時，主要考量點有二：
1.  **有哪些獨立的代理人？**
2.  **這些代理人是如何連接的？**

LangGraph 建議將此概念視覺化為一個圖（graph），其中每個代理人是一個節點（node），它們之間的連接則表示為邊緣（edge）。控制流程由邊緣管理，代理人之間透過更新圖的狀態來進行溝通。這與狀態機（state machines）的概念非常相似，代理人節點即是狀態，連接方式則是轉換矩陣。

**為何多代理人設計有益？**
*   **任務聚焦，效果更佳**：將工具或職責分組，讓單一代理人專注於特定任務，比讓一個代理人從大量工具中選擇更有效率。
*   **提示分離，效果提升**：每個代理人可以擁有獨立的指令和範例（few-shot examples），甚至可以由不同的微調 LLM 驅動。
*   **概念模型易於開發**：可以獨立評估和改進各個代理人，而不影響整體應用。複雜問題可被分解為可管理的工作單元，由專業代理人處理。

**LangGraph 的多代理人範例**
LangGraph 儲存庫提供了三個範例工作流程：

1.  **多代理人協作 (Multi Agent Collaboration)**：
    *   **代理人**：單一 LLM 呼叫，包含特定提示模板和 LLM 呼叫。
    *   **連接方式**：所有代理人共享一個訊息記錄本（scratchpad），所有工作對其他代理人都可見。由一個基於規則的路由器（router）控制狀態轉換，根據 LLM 輸出決定是否呼叫工具、回傳最終答案，或轉給其他 LLM。

2.  **代理人主管 (Agent Supervisor)**：
    *   **代理人**：獨立的 LangChain 代理人，擁有自己的提示、LLM 和工具。
    *   **連接方式**：代理人之間不共享訊息記錄本，而是有各自獨立的記錄本，其最終回應會被附加到一個全局記錄本。一個「代理人主管」負責路由到個別代理人，它本身也可以被視為一個工具是其他代理人的代理人。

3.  **階層式代理人團隊 (Hierarchical Agent Teams)**：
    *   **代理人**：節點中的代理人本身就是其他 LangGraph 物件，提供比 LangChain AgentExecutor 更高的靈活性。
    *   **連接方式**：由一個主管代理人連接這些子代理人，形成階層結構。

**第三方應用與其他框架比較**

*   **GPT-Newspaper**：一個基於 LangGraph 的自主代理人專案，可根據使用者偏好客製化報紙，由六個專業子代理人組成，包含一個 writer-critique 循環。
*   **與 Autogen 比較**：LangGraph 強調明確定義代理人與轉移機率，將其視為圖形，提供更直觀且對複雜工作流程有更好控制的開發體驗。Autogen 則更傾向於「對話」模型。
*   **與 CrewAI 比較**：CrewAI 是較高層次的框架，用於建立代理人「團隊」。LangGraph 則提供更底層、更精細的控制能力。

LangGraph 的優勢在於其圖形化的思維模式，能更好地處理複雜的代理人互動和狀態管理，並且與 LangChain 生態系深度整合，便於利用現有資源和工具。